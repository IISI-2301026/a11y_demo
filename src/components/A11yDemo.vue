<template>
  <div :class="[contrastClass, grayscaleClass, largeTextClass]">
    <a href="#main-content" class="skip-link">è·³åˆ°ä¸»è¦å…§å®¹</a>
    <header>
      <h1>ğŸŒ ç„¡éšœç¤™ç¶²é å¯¦å‹™æ¼”ç¤º</h1>
      <p class="subtitle">è®“ä½ çš„ç¶²ç«™æˆç‚ºæ‰€æœ‰äººçš„å¥½æœ‹å‹</p>
    </header>
    <nav role="navigation" aria-label="ä¸»è¦å°èˆª">
      <div class="nav-container">
        <ul class="nav-list">
          <li><a href="#forms" accesskey="1" title="Alt+1 è·³åˆ°è¡¨å–®ç¯„ä¾‹">è¡¨å–®ç¯„ä¾‹ <span class="sr-only">(Alt+1)</span></a></li>
          <li><a href="#buttons" accesskey="2" title="Alt+2 è·³åˆ°æŒ‰éˆ•ç¯„ä¾‹">æŒ‰éˆ•ç¯„ä¾‹ <span class="sr-only">(Alt+2)</span></a></li>
          <li><a href="#contrast" accesskey="3" title="Alt+3 è·³åˆ°è‰²å½©å°æ¯”">è‰²å½©å°æ¯” <span class="sr-only">(Alt+3)</span></a></li>
          <li><a href="#keyboard" accesskey="4" title="Alt+4 è·³åˆ°éµç›¤å°èˆª">éµç›¤å°èˆª <span class="sr-only">(Alt+4)</span></a></li>
          <li><a href="#aria" accesskey="5" title="Alt+5 è·³åˆ°ARIAç¯„ä¾‹">ARIAç¯„ä¾‹ <span class="sr-only">(Alt+5)</span></a></li>
          <li><a href="#modern" accesskey="6" title="Alt+6 è·³åˆ°ç¾ä»£æŠ€è¡“">ç¾ä»£æŠ€è¡“ <span class="sr-only">(Alt+6)</span></a></li>
          <li><a href="#testing" accesskey="7" title="Alt+7 è·³åˆ°æ¸¬è©¦å·¥å…·">æ¸¬è©¦å·¥å…· <span class="sr-only">(Alt+7)</span></a></li>
        </ul>
      </div>
    </nav>
    <main id="main-content">
      <!-- è¡¨å–®ç¯„ä¾‹ -->
      <section id="forms" class="demo-section">
        <h2>ğŸ“ è¡¨å–®ç„¡éšœç¤™ç¯„ä¾‹</h2>
        <div class="example-grid">
          <div class="example-card">
            <h3>âœ… å¥½çš„è¡¨å–®è¨­è¨ˆ</h3>
            <form @submit.prevent>
              <div class="form-group">
                <label for="name">å§“å <span aria-label="å¿…å¡«" style="color: #B30000;">*</span></label>
                <input type="text" id="name" v-model="form.name" required aria-required="true"
                  aria-describedby="name-help" />
                <div id="name-help" class="sr-only">è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å</div>
              </div>
              <div class="form-group">
                <label for="email">é›»å­éƒµä»¶ <span aria-label="å¿…å¡«" style="color: #B30000;">*</span></label>
                <input type="email" id="email" v-model="form.email" required aria-required="true"
                  aria-describedby="email-error" @blur="validateEmail"
                  :aria-invalid="emailInvalid ? 'true' : 'false'" />
                <div id="email-error" class="error-message" v-show="emailInvalid">è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶æ ¼å¼</div>
              </div>
              <div class="form-group">
                <label for="department">åœ˜éšŠ</label>
                <select id="department" v-model="form.department">
                  <option value="">è«‹é¸æ“‡åœ˜éšŠ</option>
                  <option value="frontend">å‰ç«¯é–‹ç™¼</option>
                  <option value="backend">å¾Œç«¯é–‹ç™¼</option>
                  <option value="design">UIUXè¨­è¨ˆ</option>
                </select>
              </div>
            </form>
          </div>
          <div class="example-card">
            <h3>âŒ ä¸å¥½çš„è¡¨å–®è¨­è¨ˆ</h3>
            <p style="font-size: 0.9rem; color: #dc2626; margin-bottom: 1rem;">
              åªç”¨placeholderä½œæç¤ºï¼Œç„¡æ³•è¢«è¢å¹•å ±è®€è»Ÿé«”æ­£ç¢ºè­˜åˆ¥ç‚ºæ¨™ç±¤
            </p>
            <form>
              <div class="form-group">
                <input type="text" placeholder="å§“å*" style="border: 1px solid #ccc;" />
              </div>
              <div class="form-group">
                <input type="text" placeholder="Email" style="border: 1px solid #ccc;" />
                <div style="color: #999; font-size: 0.9rem;">æ ¼å¼éŒ¯èª¤</div>
              </div>
              <div class="form-group">
                <select style="border: 1px solid #ccc;">
                  <option>éƒ¨é–€</option>
                  <option>å‰ç«¯</option>
                  <option>å¾Œç«¯</option>
                </select>
              </div>
            </form>
          </div>
        </div>
      </section>
      <!-- æŒ‰éˆ•ç¯„ä¾‹ -->
      <section id="buttons" class="demo-section">
        <h2>ğŸ”˜ æŒ‰éˆ•èˆ‡äº’å‹•å…ƒç´ </h2>
        <div class="example-grid">
          <div class="example-card">
            <h3>âœ… èªæ„åŒ–æŒ‰éˆ•</h3>
            <div class="button-group">
              <button class="btn btn-primary" type="submit">æäº¤è¡¨å–®</button>
              <button class="btn btn-secondary" type="button" @click="showAlert('é€™æ˜¯ä¸€å€‹å¯è¨ªå•çš„æŒ‰éˆ•ï¼')">å–æ¶ˆ</button>
              <button class="btn btn-primary" type="button" :aria-expanded="menuExpanded ? 'true' : 'false'"
                aria-controls="menu-1" @click="toggleMenu">
                é¸å–® â–¼
              </button>
            </div>
          </div>
          <div class="example-card">
            <h3>âŒ ä¸å¥½çš„æŒ‰éˆ•è¨­è¨ˆ</h3>
            <div class="button-group">
              <div class="btn btn-primary" style="cursor: pointer;">æäº¤</div>
              <span class="btn btn-secondary" style="cursor: pointer;">å–æ¶ˆ</span>
              <div style="background: #2563eb; color: white; padding: 0.75rem; cursor: pointer;">é»æˆ‘</div>
            </div>
          </div>
        </div>
      </section>
      <!-- è‰²å½©å°æ¯”ç¯„ä¾‹ -->
      <section id="contrast" class="demo-section">
        <h2>ğŸ¨ è‰²å½©å°æ¯”ç¯„ä¾‹</h2>
        <div class="contrast-examples">
          <div class="contrast-good">
            <h3>âœ… è‰¯å¥½å°æ¯”åº¦ (AAç´šåˆ¥)</h3>
            <p>é€™æ®µæ–‡å­—æœ‰è¶³å¤ çš„å°æ¯”åº¦ï¼Œç¬¦åˆWCAG 2.1 AAæ¨™æº–ã€‚å°æ¯”åº¦æ¯”ä¾‹ç‚º 4.5:1 ä»¥ä¸Šï¼Œç¢ºä¿å¤§å¤šæ•¸ç”¨æˆ¶éƒ½èƒ½è¼•é¬†é–±è®€ã€‚</p>
          </div>
          <div class="contrast-bad">
            <h3>âŒ å°æ¯”åº¦ä¸è¶³</h3>
            <p>é€™æ®µæ–‡å­—çš„å°æ¯”åº¦ä¸è¶³ï¼Œå¯èƒ½å°è¦–åŠ›ä¸ä½³æˆ–è‰²è¦ºéšœç¤™çš„ç”¨æˆ¶é€ æˆé–±è®€å›°é›£ã€‚</p>
          </div>
        </div>
      </section>
      <!-- éµç›¤å°èˆªç¯„ä¾‹ -->
      <section id="keyboard" class="demo-section">
        <h2>âŒ¨ï¸ éµç›¤å°èˆªæ¸¬è©¦å€</h2>
        <p><strong>è©¦è©¦çœ‹ï¼š</strong>ä½¿ç”¨ Tab éµç€è¦½ä¸‹é¢çš„å…ƒç´ ï¼Œè§€å¯Ÿç„¦é»æŒ‡ç¤ºå™¨</p>
        <div class="focus-demo">
          <button class="btn btn-primary">æŒ‰éˆ• 1</button>
          <a href="#" class="btn btn-secondary">é€£çµæŒ‰éˆ•</a>
          <input type="text" placeholder="è¼¸å…¥æ¡†" aria-label="è¼¸å…¥æ¡†" style="margin: 0 10px; padding: 8px;" />
          <select>
            <option>é¸é … 1</option>
            <option>é¸é … 2</option>
          </select>
        </div>
      </section>
      <!-- ARIAç¯„ä¾‹ -->
      <section id="aria" class="demo-section">
        <h2>â™¿ ARIA æ¨™ç±¤èˆ‡å‹•æ…‹å…§å®¹</h2>
        <div class="example-grid">
          <div class="example-card">
            <h3>å‹•æ…‹å…§å®¹æ›´æ–°</h3>
            <button class="btn btn-primary" @click="updateStatus">æ›´æ–°ç‹€æ…‹</button>
            <div id="status" class="live-region" aria-live="polite" aria-atomic="true">
              {{ statusText }}
            </div>
          </div>
          <div class="example-card">
            <h3>å¯å±•é–‹é¢æ¿</h3>
            <button class="btn btn-secondary" @click="togglePanel" :aria-expanded="panelExpanded ? 'true' : 'false'"
              aria-controls="expandable-panel">
              {{ panelExpanded ? 'æ”¶èµ·è©³ç´°è³‡è¨Š' : 'å±•é–‹è©³ç´°è³‡è¨Š' }}
            </button>
            <div id="expandable-panel" v-show="panelExpanded"
              style="margin-top: 1rem; padding: 1rem; background: #f0f9ff; border-radius: 4px;">
              <p>é€™æ˜¯å¯å±•é–‹çš„å…§å®¹å€åŸŸã€‚è¢å¹•å ±è®€è»Ÿé«”æœƒçŸ¥é“é€™å€‹é¢æ¿çš„å±•é–‹ç‹€æ…‹ã€‚</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- ç¾ä»£ç„¡éšœç¤™æŠ€è¡“ -->
    <section id="modern">
      <ModernA11yFeatures />
    </section>

    <!-- æ¸¬è©¦å·¥å…· -->
    <section id="testing">
      <A11yTestingTools />
    </section>

    <!-- è¼”åŠ©å·¥å…·é¢æ¿ -->
    <div class="tools-panel">
      <h4>ğŸ› ï¸ ç„¡éšœç¤™è¼”åŠ©å·¥å…·</h4>
      <!-- <button class="tool-btn" @click="toggleHighContrast">é«˜å°æ¯”æ¨¡å¼</button> -->
      <button class="tool-btn" @click="toggleGrayscale">ç°éšæ¨¡å¼</button>
      <button class="tool-btn" @click="toggleLargeText">å¤§å­—é«”æ¨¡å¼</button>
      <button class="tool-btn" @click="simulateScreenReader">æ¨¡æ“¬è¢å¹•å ±è®€</button>
    </div>

    <!-- åƒè€ƒè³‡æ–™èˆ‡ç›¸é—œè³‡æº -->
    <footer class="references-section">
      <div class="references-container">
        <h2>ğŸ“š åƒè€ƒè³‡æ–™èˆ‡ç›¸é—œè³‡æº</h2>

        <div class="references-grid">
          <!-- å®˜æ–¹æ¨™æº–èˆ‡æŒ‡å— -->
          <div class="reference-card">
            <h3>ğŸŒ å®˜æ–¹æ¨™æº–èˆ‡æŒ‡å—</h3>
            <ul class="reference-list">
              <li>
                <a href="https://www.w3.org/WAI/WCAG21/quickref/" target="_blank" rel="noopener noreferrer">
                  WCAG 2.1 å¿«é€Ÿåƒè€ƒæŒ‡å—
                </a>
                <p>W3C ç¶²é å…§å®¹ç„¡éšœç¤™æŒ‡å—çš„å®˜æ–¹å¿«é€Ÿåƒè€ƒ</p>
              </li>
              <li>
                <a href="https://www.w3.org/WAI/ARIA/apg/" target="_blank" rel="noopener noreferrer">
                  ARIA Authoring Practices Guide
                </a>
                <p>ARIA æœ€ä½³å¯¦ä½œç¯„ä¾‹èˆ‡è¨­è¨ˆæ¨¡å¼</p>
              </li>
              <li>
                <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility" target="_blank"
                  rel="noopener noreferrer">
                  MDN Web Docs - Accessibility
                </a>
                <p>Mozilla é–‹ç™¼è€…ç¶²è·¯çš„ç„¡éšœç¤™é–‹ç™¼æŒ‡å—</p>
              </li>
            </ul>
          </div>

          <!-- æ¸¬è©¦å·¥å…· -->
          <div class="reference-card">
            <h3>ğŸ§ª æ¸¬è©¦å·¥å…·èˆ‡æª¢æŸ¥å™¨</h3>
            <ul class="reference-list">
              <li>
                <a href="https://chromewebstore.google.com/detail/lhdoppojpmngadmnindnejefpokejbdd?utm_source=item-share-cb"
                  target="_blank" rel="noopener noreferrer">
                  axe DevTools
                </a>
                <p>è‡ªå‹•åŒ–ç„¡éšœç¤™æ¸¬è©¦å·¥å…·ï¼Œç€è¦½å™¨æ“´å……å¥—ä»¶</p>
              </li>
              <li>
                <a href="https://chromewebstore.google.com/detail/jbbplnpkjmmeebjpijfedlgcdilocofh?utm_source=item-share-cb"
                  target="_blank" rel="noopener noreferrer">
                  WAVE Web Accessibility Evaluator
                </a>
                <p>WebAIM æä¾›çš„å…è²»ç¶²é ç„¡éšœç¤™è©•ä¼°å·¥å…·</p>
              </li>
              <li>
                <a href="https://www.tpgi.com/color-contrast-checker/" target="_blank" rel="noopener noreferrer">
                  Color Contrast Checker
                </a>
                <p>è‰²å½©å°æ¯”åº¦æª¢æ¸¬å·¥å…·</p>
              </li>
              <li>
                <a href="https://developer.chrome.com/docs/lighthouse/overview?hl=zh-tw" target="_blank" rel="noopener noreferrer">
                  Lighthouse ç¶²é ç„¡éšœç¤™æª¢æ¸¬
                </a>
                <p>Google å®˜æ–¹çš„ç¶²ç«™æ•ˆèƒ½èˆ‡ç„¡éšœç¤™è‡ªå‹•åŒ–æª¢æ¸¬å·¥å…·</p>
              </li>
            </ul>
          </div>

          <!-- è¢å¹•å ±è®€å™¨è³‡æº -->
          <div class="reference-card">
            <h3>ğŸ”Š è¢å¹•å ±è®€å™¨èˆ‡è¼”åŠ©æŠ€è¡“</h3>
            <ul class="reference-list">
              <li>
                <a href="https://www.nvaccess.org/" target="_blank" rel="noopener noreferrer">
                  NVDA Screen Reader
                </a>
                <p>å…è²»é–‹æºè¢å¹•å ±è®€è»Ÿé«”</p>
              </li>
            </ul>
          </div>

          <!-- æ”¿åºœç›¸é—œç„¡éšœç¤™è³‡æº -->
          <div class="reference-card">
            <h3>ğŸ‡¹ğŸ‡¼ æ”¿åºœç›¸é—œç„¡éšœç¤™è³‡æº</h3>
            <ul class="reference-list">
              <li>
                <a href="https://accessibility.ncc.gov.tw/" target="_blank" rel="noopener noreferrer">
                  åœ‹å®¶é€šè¨Šå‚³æ’­å§”å“¡æœƒ - ç¶²ç«™ç„¡éšœç¤™è¦ç¯„
                </a>
                <p>å°ç£æ”¿åºœç¶²ç«™ç„¡éšœç¤™è¦ç¯„èˆ‡æª¢æ¸¬æ¨™æº–</p>
              </li>
              <li>
                <a href="https://www.handicap-free.nat.gov.tw/" target="_blank" rel="noopener noreferrer">
                  èº«å¿ƒéšœç¤™è€…æœå‹™è³‡è¨Šç¶²
                </a>
                <p>æ”¿åºœèº«å¿ƒéšœç¤™è€…ç›¸é—œæœå‹™èˆ‡è³‡è¨Š</p>
              </li>
              <li>
                <a href="https://freego.sfaa.gov.tw/" target="_blank" rel="noopener noreferrer">
                  ç„¡éšœç¤™ç’°å¢ƒè³‡è¨Šç¶²
                </a>
                <p>å°ç£ç„¡éšœç¤™ç’°å¢ƒç›¸é—œè³‡è¨Šèˆ‡è³‡æº</p>
              </li>
            </ul>
          </div>

          <!-- å…¶ä»–è³‡æº -->
          <div class="reference-card">
            <h3>âš¡ å…¶ä»–ç„¡éšœç¤™è³‡æº</h3>
            <ul class="reference-list">
              <li>
                <a href="https://vuejs.org/guide/best-practices/accessibility.html" target="_blank"
                  rel="noopener noreferrer">
                  Vue.js Accessibility Guide
                </a>
                <p>Vue.js å®˜æ–¹ç„¡éšœç¤™é–‹ç™¼æŒ‡å—</p>
              </li>
            </ul>
          </div>
        </div>

      </div>
    </footer>
  </div>
</template>

<script>
import { ref, reactive } from 'vue';
import ModernA11yFeatures from './ModernA11yFeatures.vue';
import A11yTestingTools from './A11yTestingTools.vue';

export default {
  name: 'A11yDemo',
  components: {
    ModernA11yFeatures,
    A11yTestingTools
  },
  setup() {
    // éŸ¿æ‡‰å¼æ•¸æ“š
    const form = reactive({
      name: '',
      email: '',
      department: ''
    });

    const emailInvalid = ref(false);
    const menuExpanded = ref(false);
    const statusCount = ref(0);
    const statusText = ref('ç‹€æ…‹ï¼šç­‰å¾…æ›´æ–°...');
    const panelExpanded = ref(false);
    const contrastClass = ref('');
    const grayscaleClass = ref('');
    const largeTextClass = ref('');

    // æ–¹æ³•
    const validateEmail = () => {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      emailInvalid.value = form.email && !emailRegex.test(form.email);
    };

    const showAlert = (msg) => {
      alert(msg);
    };

    const toggleMenu = () => {
      menuExpanded.value = !menuExpanded.value;
    };

    const updateStatus = () => {
      statusCount.value++;
      statusText.value = `ç‹€æ…‹ï¼šå·²æ›´æ–° ${statusCount.value} æ¬¡ - ${new Date().toLocaleTimeString()}`;
    };

    const togglePanel = () => {
      panelExpanded.value = !panelExpanded.value;
    };

    const toggleHighContrast = () => {
      contrastClass.value = contrastClass.value ? '' : 'high-contrast';
    };

    const toggleGrayscale = () => {
      grayscaleClass.value = grayscaleClass.value ? '' : 'grayscale';
    };

    const toggleLargeText = () => {
      largeTextClass.value = largeTextClass.value ? '' : 'large-text';
    };

    const simulateScreenReader = () => {
      const elements = document.querySelectorAll('h1, h2, h3, button, a, input, label');
      let index = 0;
      const statusEl = document.getElementById('status');
      function readNext() {
        if (index < elements.length) {
          const element = elements[index];
          element.focus();
          const text = element.textContent || element.getAttribute('aria-label') || element.getAttribute('alt') || 'äº’å‹•å…ƒç´ ';
          if (statusEl) statusEl.textContent = `è¢å¹•å ±è®€ï¼š${text}`;
          index++;
          setTimeout(readNext, 1500);
        }
      }
      readNext();
    };

    return {
      form,
      emailInvalid,
      menuExpanded,
      statusCount,
      statusText,
      panelExpanded,
      contrastClass,
      grayscaleClass,
      largeTextClass,
      validateEmail,
      showAlert,
      toggleMenu,
      updateStatus,
      togglePanel,
      toggleHighContrast,
      toggleGrayscale,
      toggleLargeText,
      simulateScreenReader
    };
  }
};
</script>


<style scoped>
/* åƒè€ƒè³‡æ–™å€å¡Šæ¨£å¼ */
.references-section {
  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
  padding: 3rem 0;
  margin-top: 4rem;
  border-top: 3px solid #3b82f6;
}

.references-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
}

.references-section h2 {
  text-align: center;
  color: #1e293b;
  margin-bottom: 3rem;
  font-size: 2.5rem;
  font-weight: 700;
}

.references-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 2rem;
  margin-bottom: 3rem;
}

.reference-card {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
  border: 1px solid #e5e7eb;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.reference-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
}

.reference-card h3 {
  color: #1e293b;
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
  padding-bottom: 0.75rem;
  border-bottom: 2px solid #e5e7eb;
}

.reference-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.reference-list li {
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid #f1f5f9;
}

.reference-list li:last-child {
  border-bottom: none;
  margin-bottom: 0;
  padding-bottom: 0;
}

.reference-list a {
  color: #3b82f6;
  text-decoration: none;
  font-weight: 600;
  font-size: 1rem;
  transition: color 0.2s ease;
  display: inline-block;
  margin-bottom: 0.5rem;
}

.reference-list a:hover {
  color: #1d4ed8;
  text-decoration: underline;
}

.reference-list a:focus {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
  border-radius: 2px;
}

.reference-list p {
  color: #64748b;
  font-size: 0.875rem;
  line-height: 1.5;
  margin: 0;
}


.update-info {
  font-size: 0.875rem;
  color: #64748b;
  font-style: italic;
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  .references-section {
    padding: 2rem 0;
  }

  .references-container {
    padding: 0 1rem;
  }

  .references-section h2 {
    font-size: 2rem;
    margin-bottom: 2rem;
  }

  .references-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }

  .reference-card {
    padding: 1.5rem;
  }
}

/* é«˜å°æ¯”æ¨¡å¼æ”¯æ´ */
.high-contrast .reference-card {
  border: 2px solid #000;
  background: #fff;
}

.high-contrast .reference-list a {
  color: #0000ff;
}

.high-contrast .reference-list a:visited {
  color: #800080;
}

/* å¤§å­—é«”æ¨¡å¼æ”¯æ´ */
.large-text .reference-list a {
  font-size: 1.125rem;
}

.large-text .reference-list p {
  font-size: 1rem;
}

.large-text .references-section h2 {
  font-size: 3rem;
}
</style>
